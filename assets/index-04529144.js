import{x as k,a as z,A as P,U as q,g as H,R as V,_ as O,r as l,D as W,u as m,b as t,e as s,j as e,H as Y,M as $,f as u,c as g,d as w,I as x,S as G,B as R}from"./index-82733b58.js";import{h as J}from"./moment-e9e012b5.js";import{i as K}from"./browser-image-compression-78ff6def.js";import{D as _}from"./chunk-YGVX4ESO-6b886344.js";const Q=async D=>{const C={component:"components/DonationCampaignDrawer/calls.getDonationCampaignById",params:{campaignId:D}};let d=null;try{console.log("Trying to find Donation Campaign by id",{...C});const r=k("_auth"),i=await z.get(`${P}/v1/donations/campaigns/${D}`,{headers:{Authorization:`Bearer ${r}`}});if(i.status===200&&i.data.code.id===q.SUCCESS_CODE)return{success:!0,data:i.data.content};d=H(i)}catch(r){console.error("Unexpected error while trying to find Donation Campaign by ID",{...C,error:r})}return{success:!1,data:d}},X=V.lazy(()=>O(()=>import("./index-415cd143.js"),["assets/index-415cd143.js","assets/index-82733b58.js","assets/index-8224a8ad.css","assets/index-8e59e50e.css"])),ne=({onNext:D,donationCampaign:C,campaignId:d})=>{const{appLoading:r,setAppLoading:i}=l.useContext(W),[n,c]=l.useState({nameEn:"",contentEn:"",startDate:"",endDate:"",imageURL:null}),[v,y]=l.useState(!1),[A,U]=l.useState(""),[b,B]=l.useState(null),I=m("border-gray-300","border-gray-500");m("white","gray.500");const L=async()=>{i(!0),y(!1);try{const a=await Q(d);if(!a.success)throw y(!0),B({type:"error",message:a.data}),new Error(a.data);T(a.data)}catch(a){console.error("Error : ",{...a})}i(!1)},T=a=>{c(o=>({...o,...a}))},N=()=>{c({nameEn:"",contentEn:"",startDate:"",endDate:""}),y(!1)},E=a=>{const{name:o,value:S}=a.target;c(f=>({...f,[o]:S}))},F=a=>{c(o=>({...o,description:a}))},M=async a=>{const o=a.target.files[0],f=await K(o,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0});if(f){const p=new FileReader;p.onload=()=>{c(j=>({...j,imageURL:p.result}))},p.readAsDataURL(f)}else c(p=>({...p,imageURL:null}))},h=a=>J(a).tz("America/Toronto").format("YYYY-MM-DDTHH:mm");return l.useEffect(()=>{if(n.startDate&&n.startDate.length&&!n.endDate&&n.endDate.length){const a=h(new Date(n.startDate));c(o=>({...o,endTime:a})),U(a)}},[n.startDate]),l.useEffect(()=>(d&&L(),()=>N()),[]),t(s,{children:[e(s,{mt:"15px",children:e(Y,{as:"h3",size:"lg",my:5,mx:{base:"15px",sm:"5px"},children:"Fill in Donation Campaign information"})}),v&&b&&e(s,{mb:5,children:e($,{type:b.type,message:b.message})}),t(s,{className:`${I} border w-full rounded-lg flex flex-col items-center my-6`,p:{base:"0px",md:"25px"},bg:m("gray.50","gray.700"),children:[t(s,{className:"w-full flex md:flex-row flex-col",children:[t(s,{className:"md:w-4/12 w-full p-3 flex flex-col",children:[e("span",{className:"text-md font-bold w-full",children:"Campaign Information"}),e("span",{className:"mt-2 text-sm w-10/12",children:"This information will be used to be displayed on the website."})]}),t(s,{className:"sm:w-10/12 w-full p-3",children:[e(u,{direction:{base:"column",md:"row"},justifyContent:"space-between",children:t(g,{mr:"5%",isRequired:!0,children:[e(w,{children:"Donation Campaign Name"}),e(x,{type:"text",name:"name",value:n.nameEn,disabled:r,onChange:E})]})}),e(u,{direction:{base:"column",md:"row"},justifyContent:"space-between",mt:5,children:t(g,{mr:"5%",isRequired:!0,children:[e(w,{children:"Campaign Description"}),e(l.Suspense,{fallback:e(G,{size:"xs"}),children:e(X,{initialContent:n.contentEn,onSave:F})})]})})]})]}),e(_,{my:10}),t(s,{className:"w-full flex md:flex-row flex-col",children:[t(s,{className:"md:w-4/12 w-full p-3 flex flex-col",children:[e("span",{className:"text-md font-bold w-full",children:"Campaign Image"}),e("span",{className:"mt-2 text-sm w-10/12",children:"Upload an image, it will be used as a donation campaign promotion image."})]}),e(s,{className:"sm:w-10/12 w-full p-3",children:t(u,{direction:{base:"column"},justifyContent:"space-between",children:[e(g,{mr:"5%",isRequired:!0,children:e(x,{type:"file",accept:"image/*",onChange:M,p:1})}),e(s,{my:5,children:n.imageURL&&e("img",{src:n.imageURL,alt:"Preview",style:{maxWidth:"100px"}})})]})})]}),e(_,{my:10}),t(s,{className:"w-full flex md:flex-row flex-col",children:[t(s,{className:"md:w-4/12 w-full p-3 flex flex-col",children:[e("span",{className:"text-md font-bold w-full",children:"Donation Campaign duration"}),e("span",{className:"mt-2 text-sm w-10/12",children:"Please, select campaign start and end dates."})]}),e(s,{className:"w-10/12 p-3",children:t(u,{direction:{base:"column",md:"row"},justifyContent:"space-between",children:[t(g,{mr:"5%",isRequired:!0,children:[e(w,{children:"Start time"}),e(x,{type:"date",name:"startTime",value:h(n.startDate&&n.startDate.length?new Date(n.startDate):new Date),onChange:E,disabled:r,min:h(new Date)})]}),t(g,{mr:"5%",ml:{base:"0",md:"5"},isRequired:!0,children:[e(w,{children:"End time"}),e(x,{type:"date",name:"endTime",value:h(new Date(n.endDate)),disabled:r,onChange:E,min:A})]})]})})]}),t(u,{my:10,className:"w-full flex",justifyContent:"end",children:[e(R,{colorScheme:"red",mr:"2%",className:"sm:w-24 w-6/12",color:m("white","gray.100"),disabled:r,onClick:N,children:"Reset"}),e(R,{colorScheme:"blue",className:"sm:w-24 w-6/12",_hover:{bg:m("green.400","green.500")},color:m("white","gray.100"),bg:m("green.500","green.600"),disabled:r,onClick:()=>console.log({formValues:n}),children:"Save"})]})]})]})};export{ne as default};
