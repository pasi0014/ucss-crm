import{x as U,a as Y,A as $,U as G,g as j,j as i,e as b,b as h,u as P,B as I,y as Q,z,R as O,C as fe,r as A,D as se,N as we,J as ge,M as Ce,P as Ne,H as k}from"./index-82733b58.js";import{h as T}from"./moment-e9e012b5.js";import{G as V}from"./iconBase-94f617a1.js";import{M as pe,a as Ee,F as Me}from"./index.esm-cc4aab74.js";import{M as ae,a as re,b as xe,B as Ae}from"./index.esm-f399c37e.js";import{T as ye,a as be,b as Re,c as q,d as ee,e as Se,f as H}from"./chunk-Z3IFIKNA-de6e62c4.js";import{B as X,u as ne,w as ve}from"./withStatus-59df8a06.js";import{a as Ie,b as Pe}from"./index.esm-bcfda23f.js";import{C as _e}from"./chunk-QDPMOBCK-e3dd7d26.js";import{l as De,E as Te,P as ze,R as Be}from"./index-a9922210.js";import{D as Fe,a as Oe,M as Le}from"./chunk-JIPYISAW-16bb16c3.js";import{M as le,a as oe,b as ie,c as ce}from"./chunk-XY72533R-e88ac3d9.js";import"./chunk-LB6CWFOC-1198bd88.js";import"./useMobile-94845e00.js";import"./chunk-VJ54TX72-f424b5a1.js";import"./chunk-CHB4ZXZG-c62fd995.js";import"./chunk-UC35PMV4-bc7790c7.js";import"./chunk-ROURZMX4-1c85f1b1.js";import"./chunk-3XANSPY5-cf37bc50.js";async function ke(o){const a={component:"components/ReservationView.calls.getReservation",params:{reservationId:o}};let l=null;try{console.log("Fetching Reservation",{...a});const c=U("_auth"),f=await Y.get(`${$}/v1/reservations/${o}`,{headers:{Authorization:`Bearer ${c}`}});if(f.status===200&&f.data.code.id===G.SUCCESS_CODE)return{success:!0,data:f.data.content};l=j(f)}catch(c){console.error("An unexpected error while fetching Reservation",{...a,error:c})}return{success:!1,data:l}}async function He(o){const a={component:"components/ReservationView.calls.confirmReservation",params:{reservationId:o}};let l=null;try{console.log("Confirming Reservation",{...a});const c=U("_auth"),f=await Y.put(`${$}/v1/reservations/${o}`,{},{headers:{Authorization:`Bearer ${c}`}});if(f.status===200&&f.data.code.id===G.SUCCESS_CODE)return{success:!0,data:f.data.content};l=j(f)}catch(c){console.error("An unexpected error while fetching Reservation",{...a,error:c})}return{success:!1,data:l}}function Ue(o){return V({tag:"svg",attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14.5c-3.59 0-6.5-2.91-6.5-6.5s2.91-6.5 6.5-6.5 6.5 2.91 6.5 6.5-2.91 6.5-6.5 6.5z"}},{tag:"path",attr:{d:"M10.5 4l-2.5 2.5-2.5-2.5-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 2.5-2.5 2.5 2.5 1.5-1.5-2.5-2.5 2.5-2.5z"}}]})(o)}function Ye(o){return V({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.0049 2C17.5277 2 22.0049 6.47715 22.0049 12C22.0049 17.5228 17.5277 22 12.0049 22C9.57847 22 7.3539 21.1358 5.62216 19.6985L5.37815 19.4892L6.27949 17.5875C7.73229 19.0759 9.76067 20 12.0049 20C16.4232 20 20.0049 16.4183 20.0049 12C20.0049 7.58172 16.4232 4 12.0049 4C7.66997 4 4.14034 7.44784 4.00869 11.7508L4.00488 12H6.50488L3.79854 17.7161C2.66796 16.096 2.00488 14.1254 2.00488 12C2.00488 6.47715 6.48204 2 12.0049 2ZM13.0049 6V8H15.5049V10H10.0049C9.72874 10 9.50488 10.2239 9.50488 10.5C9.50488 10.7455 9.68176 10.9496 9.91501 10.9919L10.0049 11H14.0049C15.3856 11 16.5049 12.1193 16.5049 13.5C16.5049 14.8807 15.3856 16 14.0049 16H13.0049V18H11.0049V16H8.50488V14H14.0049C14.281 14 14.5049 13.7761 14.5049 13.5C14.5049 13.2545 14.328 13.0504 14.0948 13.0081L14.0049 13H10.0049C8.62417 13 7.50488 11.8807 7.50488 10.5C7.50488 9.11929 8.62417 8 10.0049 8H11.0049V6H13.0049Z"}}]})(o)}const $e=({statuses:o,paymentIntents:a})=>{const l=[{header:"ID",accessor:"id"},{header:"Amount",accessor:"totalWithFees",render:d=>h("span",{children:["$",d]})},{header:"Status",accessor:"StatusId",render:d=>i(X,{colorScheme:Q(z(o.Invoice,d).tag||""),children:z(o.Invoice,d).tag})},{header:"Updated At",accessor:"updatedAt",render:d=>T(d).tz("America/Toronto").format("DD MMM, YYYY [at] HH:mma")},{header:"Created",accessor:"createdAt",render:d=>T(d).tz("America/Toronto").format("DD MMM, YYYY [at] HH:mma")},{header:"Created By",accessor:"createdBy"}],c=(d,w)=>w.render?w.render(d[w.accessor],d):d[w.accessor],f=a==null?void 0:a.find(d=>d.StatusId===o.Invoice.PENDING);return i(b,{children:i(ye,{children:h(be,{bg:P("white","gray.800"),color:P("gray.800","white"),borderRadius:"15px",shadow:"sm",overflowY:"scroll",size:{base:"sm",md:"md"},children:[i(Re,{children:h(q,{children:[l.map(d=>h(ee,{children:[d.header," "]},d.accessor)),i(ee,{children:"Actions"})]})}),i(Se,{children:a==null?void 0:a.map(d=>h(q,{children:[l.map(w=>i(H,{children:i("div",{children:c(d,w)})},w.accessor)),f?i(H,{children:h(I,{colorScheme:"orange",size:{base:"sm",md:"md"},className:"ml-2",children:[i(ae,{className:"mr-2"})," ",i("span",{children:"Pay"})]})}):i(H,{children:h(I,{size:{base:"sm",md:"md"},colorScheme:"teal",children:[i(Ye,{className:"mr-2"})," Refund"]})})]},d.id.toString()))})]})})})};function Ge(o){return V({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M426.24 127.72l-10.94 10.94a29.67 29.67 0 01-42-42l10.94-10.94L314.52 16l-88 88-4 12.09-12.09 4L16 314.52l69.76 69.76 10.94-10.94a29.67 29.67 0 0142 42l-10.94 10.94L197.48 496l194.4-194.4 4-12.09 12.09-4 88-88zm-208.56 5.43l21.87-21.87 33 33-21.88 21.87zm43 43l21.88-21.88 32.52 32.52-21.88 21.88zm42.56 42.56l21.88-21.88 32.52 32.52-21.84 21.93zm75.57 75.56l-33-33 21.87-21.88 33 33z"}}]})(o)}var je=Object.defineProperty,L=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,te=(o,a,l)=>a in o?je(o,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[a]=l,Qe=(o,a)=>{for(var l in a||(a={}))de.call(a,l)&&te(o,l,a[l]);if(L)for(var l of L(a))he.call(a,l)&&te(o,l,a[l]);return o},Ve=(o,a)=>{var l={};for(var c in o)de.call(o,c)&&a.indexOf(c)<0&&(l[c]=o[c]);if(o!=null&&L)for(var c of L(o))a.indexOf(c)<0&&he.call(o,c)&&(l[c]=o[c]);return l};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var _;(o=>{const a=class{constructor(t,s,e,r){if(this.version=t,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],t<a.MIN_VERSION||t>a.MAX_VERSION)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let n=[];for(let m=0;m<this.size;m++)n.push(!1);for(let m=0;m<this.size;m++)this.modules.push(n.slice()),this.isFunction.push(n.slice());this.drawFunctionPatterns();const u=this.addEccAndInterleave(e);if(this.drawCodewords(u),r==-1){let m=1e9;for(let g=0;g<8;g++){this.applyMask(g),this.drawFormatBits(g);const C=this.getPenaltyScore();C<m&&(r=g,m=C),this.applyMask(g)}}d(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}static encodeText(t,s){const e=o.QrSegment.makeSegments(t);return a.encodeSegments(e,s)}static encodeBinary(t,s){const e=o.QrSegment.makeBytes(t);return a.encodeSegments([e],s)}static encodeSegments(t,s,e=1,r=40,n=-1,u=!0){if(!(a.MIN_VERSION<=e&&e<=r&&r<=a.MAX_VERSION)||n<-1||n>7)throw new RangeError("Invalid value");let m,g;for(m=e;;m++){const N=a.getNumDataCodewords(m,s)*8,x=p.getTotalBits(t,m);if(x<=N){g=x;break}if(m>=r)throw new RangeError("Data too long")}for(const N of[a.Ecc.MEDIUM,a.Ecc.QUARTILE,a.Ecc.HIGH])u&&g<=a.getNumDataCodewords(m,N)*8&&(s=N);let C=[];for(const N of t){c(N.mode.modeBits,4,C),c(N.numChars,N.mode.numCharCountBits(m),C);for(const x of N.getData())C.push(x)}d(C.length==g);const S=a.getNumDataCodewords(m,s)*8;d(C.length<=S),c(0,Math.min(4,S-C.length),C),c(0,(8-C.length%8)%8,C),d(C.length%8==0);for(let N=236;C.length<S;N^=253)c(N,8,C);let v=[];for(;v.length*8<C.length;)v.push(0);return C.forEach((N,x)=>v[x>>>3]|=N<<7-(x&7)),new a(m,s,v,n)}getModule(t,s){return 0<=t&&t<this.size&&0<=s&&s<this.size&&this.modules[s][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),s=t.length;for(let e=0;e<s;e++)for(let r=0;r<s;r++)e==0&&r==0||e==0&&r==s-1||e==s-1&&r==0||this.drawAlignmentPattern(t[e],t[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const s=this.errorCorrectionLevel.formatBits<<3|t;let e=s;for(let n=0;n<10;n++)e=e<<1^(e>>>9)*1335;const r=(s<<10|e)^21522;d(r>>>15==0);for(let n=0;n<=5;n++)this.setFunctionModule(8,n,f(r,n));this.setFunctionModule(8,7,f(r,6)),this.setFunctionModule(8,8,f(r,7)),this.setFunctionModule(7,8,f(r,8));for(let n=9;n<15;n++)this.setFunctionModule(14-n,8,f(r,n));for(let n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,f(r,n));for(let n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,f(r,n));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let e=0;e<12;e++)t=t<<1^(t>>>11)*7973;const s=this.version<<12|t;d(s>>>18==0);for(let e=0;e<18;e++){const r=f(s,e),n=this.size-11+e%3,u=Math.floor(e/3);this.setFunctionModule(n,u,r),this.setFunctionModule(u,n,r)}}drawFinderPattern(t,s){for(let e=-4;e<=4;e++)for(let r=-4;r<=4;r++){const n=Math.max(Math.abs(r),Math.abs(e)),u=t+r,m=s+e;0<=u&&u<this.size&&0<=m&&m<this.size&&this.setFunctionModule(u,m,n!=2&&n!=4)}}drawAlignmentPattern(t,s){for(let e=-2;e<=2;e++)for(let r=-2;r<=2;r++)this.setFunctionModule(t+r,s+e,Math.max(Math.abs(r),Math.abs(e))!=1)}setFunctionModule(t,s,e){this.modules[s][t]=e,this.isFunction[s][t]=!0}addEccAndInterleave(t){const s=this.version,e=this.errorCorrectionLevel;if(t.length!=a.getNumDataCodewords(s,e))throw new RangeError("Invalid argument");const r=a.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][s],n=a.ECC_CODEWORDS_PER_BLOCK[e.ordinal][s],u=Math.floor(a.getNumRawDataModules(s)/8),m=r-u%r,g=Math.floor(u/r);let C=[];const S=a.reedSolomonComputeDivisor(n);for(let N=0,x=0;N<r;N++){let M=t.slice(x,x+g-n+(N<m?0:1));x+=M.length;const y=a.reedSolomonComputeRemainder(M,S);N<m&&M.push(0),C.push(M.concat(y))}let v=[];for(let N=0;N<C[0].length;N++)C.forEach((x,M)=>{(N!=g-n||M>=m)&&v.push(x[N])});return d(v.length==u),v}drawCodewords(t){if(t.length!=Math.floor(a.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let e=this.size-1;e>=1;e-=2){e==6&&(e=5);for(let r=0;r<this.size;r++)for(let n=0;n<2;n++){const u=e-n,g=(e+1&2)==0?this.size-1-r:r;!this.isFunction[g][u]&&s<t.length*8&&(this.modules[g][u]=f(t[s>>>3],7-(s&7)),s++)}}d(s==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){let r;switch(t){case 0:r=(e+s)%2==0;break;case 1:r=s%2==0;break;case 2:r=e%3==0;break;case 3:r=(e+s)%3==0;break;case 4:r=(Math.floor(e/3)+Math.floor(s/2))%2==0;break;case 5:r=e*s%2+e*s%3==0;break;case 6:r=(e*s%2+e*s%3)%2==0;break;case 7:r=((e+s)%2+e*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][e]&&r&&(this.modules[s][e]=!this.modules[s][e])}}getPenaltyScore(){let t=0;for(let n=0;n<this.size;n++){let u=!1,m=0,g=[0,0,0,0,0,0,0];for(let C=0;C<this.size;C++)this.modules[n][C]==u?(m++,m==5?t+=a.PENALTY_N1:m>5&&t++):(this.finderPenaltyAddHistory(m,g),u||(t+=this.finderPenaltyCountPatterns(g)*a.PENALTY_N3),u=this.modules[n][C],m=1);t+=this.finderPenaltyTerminateAndCount(u,m,g)*a.PENALTY_N3}for(let n=0;n<this.size;n++){let u=!1,m=0,g=[0,0,0,0,0,0,0];for(let C=0;C<this.size;C++)this.modules[C][n]==u?(m++,m==5?t+=a.PENALTY_N1:m>5&&t++):(this.finderPenaltyAddHistory(m,g),u||(t+=this.finderPenaltyCountPatterns(g)*a.PENALTY_N3),u=this.modules[C][n],m=1);t+=this.finderPenaltyTerminateAndCount(u,m,g)*a.PENALTY_N3}for(let n=0;n<this.size-1;n++)for(let u=0;u<this.size-1;u++){const m=this.modules[n][u];m==this.modules[n][u+1]&&m==this.modules[n+1][u]&&m==this.modules[n+1][u+1]&&(t+=a.PENALTY_N2)}let s=0;for(const n of this.modules)s=n.reduce((u,m)=>u+(m?1:0),s);const e=this.size*this.size,r=Math.ceil(Math.abs(s*20-e*10)/e)-1;return d(0<=r&&r<=9),t+=r*a.PENALTY_N4,d(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let e=[6];for(let r=this.size-7;e.length<t;r-=s)e.splice(1,0,r);return e}}static getNumRawDataModules(t){if(t<a.MIN_VERSION||t>a.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*t+128)*t+64;if(t>=2){const e=Math.floor(t/7)+2;s-=(25*e-10)*e-55,t>=7&&(s-=36)}return d(208<=s&&s<=29648),s}static getNumDataCodewords(t,s){return Math.floor(a.getNumRawDataModules(t)/8)-a.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*a.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let s=[];for(let r=0;r<t-1;r++)s.push(0);s.push(1);let e=1;for(let r=0;r<t;r++){for(let n=0;n<s.length;n++)s[n]=a.reedSolomonMultiply(s[n],e),n+1<s.length&&(s[n]^=s[n+1]);e=a.reedSolomonMultiply(e,2)}return s}static reedSolomonComputeRemainder(t,s){let e=s.map(r=>0);for(const r of t){const n=r^e.shift();e.push(0),s.forEach((u,m)=>e[m]^=a.reedSolomonMultiply(u,n))}return e}static reedSolomonMultiply(t,s){if(t>>>8||s>>>8)throw new RangeError("Byte out of range");let e=0;for(let r=7;r>=0;r--)e=e<<1^(e>>>7)*285,e^=(s>>>r&1)*t;return d(e>>>8==0),e}finderPenaltyCountPatterns(t){const s=t[1];d(s<=this.size*3);const e=s>0&&t[2]==s&&t[3]==s*3&&t[4]==s&&t[5]==s;return(e&&t[0]>=s*4&&t[6]>=s?1:0)+(e&&t[6]>=s*4&&t[0]>=s?1:0)}finderPenaltyTerminateAndCount(t,s,e){return t&&(this.finderPenaltyAddHistory(s,e),s=0),s+=this.size,this.finderPenaltyAddHistory(s,e),this.finderPenaltyCountPatterns(e)}finderPenaltyAddHistory(t,s){s[0]==0&&(t+=this.size),s.pop(),s.unshift(t)}};let l=a;l.MIN_VERSION=1,l.MAX_VERSION=40,l.PENALTY_N1=3,l.PENALTY_N2=3,l.PENALTY_N3=40,l.PENALTY_N4=10,l.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],l.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],o.QrCode=l;function c(t,s,e){if(s<0||s>31||t>>>s)throw new RangeError("Value out of range");for(let r=s-1;r>=0;r--)e.push(t>>>r&1)}function f(t,s){return(t>>>s&1)!=0}function d(t){if(!t)throw new Error("Assertion error")}const w=class{constructor(t,s,e){if(this.mode=t,this.numChars=s,this.bitData=e,s<0)throw new RangeError("Invalid argument");this.bitData=e.slice()}static makeBytes(t){let s=[];for(const e of t)c(e,8,s);return new w(w.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!w.isNumeric(t))throw new RangeError("String contains non-numeric characters");let s=[];for(let e=0;e<t.length;){const r=Math.min(t.length-e,3);c(parseInt(t.substr(e,r),10),r*3+1,s),e+=r}return new w(w.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){if(!w.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],e;for(e=0;e+2<=t.length;e+=2){let r=w.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e))*45;r+=w.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e+1)),c(r,11,s)}return e<t.length&&c(w.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e)),6,s),new w(w.Mode.ALPHANUMERIC,t.length,s)}static makeSegments(t){return t==""?[]:w.isNumeric(t)?[w.makeNumeric(t)]:w.isAlphanumeric(t)?[w.makeAlphanumeric(t)]:[w.makeBytes(w.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)c(t,8,s);else if(t<16384)c(2,2,s),c(t,14,s);else if(t<1e6)c(6,3,s),c(t,21,s);else throw new RangeError("ECI assignment value out of range");return new w(w.Mode.ECI,0,s)}static isNumeric(t){return w.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return w.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,s){let e=0;for(const r of t){const n=r.mode.numCharCountBits(s);if(r.numChars>=1<<n)return 1/0;e+=4+n+r.bitData.length}return e}static toUtf8ByteArray(t){t=encodeURI(t);let s=[];for(let e=0;e<t.length;e++)t.charAt(e)!="%"?s.push(t.charCodeAt(e)):(s.push(parseInt(t.substr(e+1,2),16)),e+=2);return s}};let p=w;p.NUMERIC_REGEX=/^[0-9]*$/,p.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,p.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",o.QrSegment=p})(_||(_={}));(o=>{(a=>{const l=class{constructor(f,d){this.ordinal=f,this.formatBits=d}};let c=l;c.LOW=new l(0,1),c.MEDIUM=new l(1,0),c.QUARTILE=new l(2,3),c.HIGH=new l(3,2),a.Ecc=c})(o.QrCode||(o.QrCode={}))})(_||(_={}));(o=>{(a=>{const l=class{constructor(f,d){this.modeBits=f,this.numBitsCharCount=d}numCharCountBits(f){return this.numBitsCharCount[Math.floor((f+7)/17)]}};let c=l;c.NUMERIC=new l(1,[10,12,14]),c.ALPHANUMERIC=new l(2,[9,11,13]),c.BYTE=new l(4,[8,16,16]),c.KANJI=new l(8,[8,10,12]),c.ECI=new l(7,[0,0,0]),a.Mode=c})(o.QrSegment||(o.QrSegment={}))})(_||(_={}));var F=_;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Xe={L:F.QrCode.Ecc.LOW,M:F.QrCode.Ecc.MEDIUM,Q:F.QrCode.Ecc.QUARTILE,H:F.QrCode.Ecc.HIGH},We=128,Ke="L",Ze="#FFFFFF",Je="#000000",qe=!1,me=4,et=.1;function tt(o,a=0){const l=[];return o.forEach(function(c,f){let d=null;c.forEach(function(w,p){if(!w&&d!==null){l.push(`M${d+a} ${f+a}h${p-d}v1H${d+a}z`),d=null;return}if(p===c.length-1){if(!w)return;d===null?l.push(`M${p+a},${f+a} h1v1H${p+a}z`):l.push(`M${d+a},${f+a} h${p+1-d}v1H${d+a}z`);return}w&&d===null&&(d=p)})}),l.join("")}function st(o,a){return o.slice().map((l,c)=>c<a.y||c>=a.y+a.h?l:l.map((f,d)=>d<a.x||d>=a.x+a.w?f:!1))}function at(o,a,l,c){if(c==null)return null;const f=l?me:0,d=o.length+f*2,w=Math.floor(a*et),p=d/a,t=(c.width||w)*p,s=(c.height||w)*p,e=c.x==null?o.length/2-t/2:c.x*p,r=c.y==null?o.length/2-s/2:c.y*p;let n=null;if(c.excavate){let u=Math.floor(e),m=Math.floor(r),g=Math.ceil(t+e-u),C=Math.ceil(s+r-m);n={x:u,y:m,w:g,h:C}}return{x:e,y:r,h:s,w:t,excavation:n}}(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function rt(o){const a=o,{value:l,size:c=We,level:f=Ke,bgColor:d=Ze,fgColor:w=Je,includeMargin:p=qe,imageSettings:t}=a,s=Ve(a,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let e=F.QrCode.encodeText(l,Xe[f]).getModules();const r=p?me:0,n=e.length+r*2,u=at(e,c,p,t);let m=null;t!=null&&u!=null&&(u.excavation!=null&&(e=st(e,u.excavation)),m=O.createElement("image",{xlinkHref:t.src,height:u.h,width:u.w,x:u.x+r,y:u.y+r,preserveAspectRatio:"none"}));const g=tt(e,r);return O.createElement("svg",Qe({height:c,width:c,viewBox:`0 0 ${n} ${n}`},s),O.createElement("path",{fill:d,d:`M0,0 h${n}v${n}H0z`,shapeRendering:"crispEdges"}),O.createElement("path",{fill:w,d:g,shapeRendering:"crispEdges"}),m)}function nt(o="",a=""){const l=o.charAt(0).toUpperCase(),c=a.charAt(0).toUpperCase();return`${l}${c}`}const lt=({statuses:o,clientList:a,enableDelete:l=!0,onDelete:c,onEdit:f,onCheckIn:d})=>{var p,t,s,e;const w=r=>{};return h(b,{className:"flex flex-col rounded-xl shadow-md p-3",bg:P("gray.50","gray.600"),children:[h("div",{className:"flex sm:flex-row flex-col justify-space-between",children:[i(b,{className:"hidden sm:inline-flex items-center justify-center rounded-full shadow-sm h-10 w-10 mr-3 text-sm font-bold",bg:P("blue.100","blue.300"),children:nt((p=a.Client)==null?void 0:p.firstName,a.Client.lastName)}),h("div",{className:"flex flex-col sm:w-4/12 w-full space-y-2",children:[i("div",{children:`${a.Client.firstName} ${a.Client.lastName}`}),h("div",{className:"text-xs flex flex-row items-center",children:[i(Ie,{className:"mr-2"}),i("span",{children:a.Client.phone})]}),h("div",{className:"text-xs flex flex-row items-center",children:[i(re,{className:"mr-2 text-md"}),i("span",{children:a.Client.email})]}),h("div",{className:"text-xs flex flex-row items-center",children:["Status:"," ",i(X,{className:"ml-2",colorScheme:Q(z(o.ClientList,a.StatusId).tag||""),children:z(o.ClientList,a.StatusId).tag})]}),h("div",{className:"text-xs flex flex-row items-center",children:[i("span",{children:"Created: "}),i("span",{className:"ml-1",children:T(a.createdAt).tz("America/Toronto").utc().format("DD MMM, YYYY [at] HH:mm")})]})]}),h("div",{className:"flex flex-row sm:w-4/12 w-full sm:my-auto my-5 h-full items-center align-baseline text-base",children:[i(Ge,{className:"mr-2"})," ",h("span",{children:[(t=a.Price)==null?void 0:t.name," | ",((s=a.Price)==null?void 0:s.ticketType)==="free"?"Free":`$${(e=a.Price)==null?void 0:e.amount}`]})]}),h("div",{className:"flex flex-col justify-end mx-auto p-1",children:[i(rt,{value:a.reservationCode||"",size:96,className:"mx-auto"}),h("span",{className:"text-center text-xs mt-2",children:["ReservationCode: ",a.reservationCode]})]})]}),h("div",{className:"flex sm:flex-row flex-col",children:[i("div",{className:"flex flex-row justify-start p-3 sm:w-8/12 w-full",children:h(I,{className:"mt-2 sm:w-6/12 w-full  mr-2",colorScheme:"green",size:{base:"xs",md:"sm"},onClick:()=>d(a),children:[i(_e,{className:"mr-2"})," Check in"]})}),h("div",{className:"flex flex-row justify-end p-3 sm:w-8/12 w-full",children:[h(I,{className:"mt-2 sm:w-6/12 w-full mr-2",colorScheme:"orange",size:{base:"xs",md:"sm"},onClick:()=>f&&f(a),children:[i(xe,{className:"mr-2"})," Edit"]}),l&&h(I,{className:"mt-2 sm:w-6/12 w-full",colorScheme:"red",size:{base:"xs",md:"sm"},onClick:()=>w(),children:[i(Pe,{className:"mr-2"})," Delete Guest"]})]})]})]})},ot=async({invoiceItems:o,reservationId:a})=>{const l={component:"components/PaymentDrawer/calls.findOrCreatePaymentIntent",params:{invoiceItems:o,reservationId:a}};let c=null;try{console.log("Creating payment intent",{...l});const f=U("_auth"),d=await Y.post(`${$}/v1/payments/intent`,{invoiceItems:o,reservationId:a},{headers:{Authorization:`Bearer ${f}`}});if(d.status===200&&d.data.code.id===G.SUCCESS_CODE)return{success:!0,data:d.data.content};c=j(d)}catch(f){console.error("Unexpected error while trying to create a PaymentIntent",f)}return{success:!1,data:c}},it=De("pk_test_51IrRRsGjXTlWWmWRMoG1XmMgg8BBVujyfAxX4b4FD5jqPZiq0wz6RjkIvjn67W5bjiiOZEk7eL7UYoMAYE73ILHu00KDp26GXa"),ct=({isOpen:o,onClose:a,invoice:l,eventId:c,reservationId:f,onSuccessPayment:d})=>{const w=P("gray.200","gray.800");fe();const p=ne(),{setAppLoading:t}=A.useContext(se),[s,e]=A.useState(""),[r,n]=A.useState(0),[u,m]=A.useState(null),[g,C]=A.useState([]),S=async M=>{if(M){t(!0),m(null);try{const y=await ot({reservationId:f,invoiceItems:g});if(!y.success){p({title:"Error",description:"There was an error with an API",position:"top-left",status:"error",duration:5e3,isClosable:!0}),t(!1);return}e(y.data.clientSecret)}catch(y){console.error(`Error :: ${y.message}`),m({type:"error",message:y.message})}t(!1)}};A.useEffect(()=>{if(l){C(l.InvoiceItems);const{totalFees:M}=we(l.totalAmount);n(M)}},[l]),A.useEffect(()=>{let M=!0;return g.length&&o&&M&&S(M),()=>{M=!1}},[g,o]);const v={theme:P("flat","night")},N={clientSecret:s,appearance:v};function x(M){const y={};return M.forEach(R=>{const D=R.PriceId;y[D]?y[D].count++:y[D]={count:1,price:R.Price}}),Object.values(y).map(R=>i(b,{children:R.count>1?i("div",{children:`${R.count} x ${R.price.name} | $CAD ${R.price.amount}`}):i("div",{children:`1 x ${R.price.name} | $CAD ${R.price.amount}`})},R.price.id))}return h(Fe,{isOpen:o,onClose:a,size:"md",children:[i(le,{}),h(Oe,{children:[i(oe,{}),i(ie,{children:"Payments"}),h(ce,{children:[l&&!!g.length&&h(b,{p:5,boxShadow:"md",bg:w,borderRadius:"15px",mb:5,children:[i("h2",{className:"text-xl font-bold mb-2",children:"Order Details"}),h(b,{className:"font-bold text-lg mb-2",children:[l==null?void 0:l.Client.firstName," ",l==null?void 0:l.Client.lastName]}),x(g),h(b,{className:"font-medium text-base my-2",children:["Payment Processing Fees: ",h("b",{children:["$CAD",r]})]}),h(b,{className:"font-medium text-base mt-3",children:["Total: $CAD",i("b",{children:parseInt(l.totalAmount,10)+r})]})]}),i(b,{bg:w,p:5,borderRadius:"15px",boxShadow:"md",children:s&&i(Te,{options:N,stripe:it,children:i(ze,{onPaymentSuccess:()=>d(l==null?void 0:l.id),eventId:c,clientSecret:s,reservationId:f})})})]})]})]})},dt=o=>{var y,R,D,W,K,Z,J;const a=ne(),{reservationId:l}=ge(),{setAppLoading:c}=A.useContext(se),[f,d]=A.useState(!1),[w,p]=A.useState(!1),[t,s]=A.useState(!1),[e,r]=A.useState(),[n,u]=A.useState([]),[m,g]=A.useState(!0),[C,S]=A.useState(null),v=P("white","gray.700");A.useEffect(()=>{l&&N()},[l]),A.useEffect(()=>{var E;if(o.statuses){if(e&&((E=e.Invoices)!=null&&E.length)&&e.StatusId===o.statuses.Reservation.AWAITING_PAYMENT){const B=e==null?void 0:e.Invoices.filter(ue=>ue.StatusId===o.statuses.Invoice.PENDING);u(B)}e&&e.ClientLists.length<=1&&g(!1)}},[e,o.statuses]);const N=async()=>{c(!1),S(null);try{const E=await ke(l);if(!E.success)throw new Error(E.data);r(E.data)}catch(E){console.error(`Error :: ${E.message}`),S({type:"error",message:E.message})}c(!1)},x=async()=>{c(!0),S(null);try{const E=await He(l);if(!E.success)throw new Error(E.data);r(E.data),a({title:"Success",description:"Reservation has been activated! Confirmation Email has been sent to the customer.",position:"top-right",status:"success",duration:9e3,isClosable:!0})}catch(E){console.error(`Error :: ${E.message}`),S({type:"error",message:E.message})}d(!1),c(!1)},M=async E=>{N(),s(!1),u(n.filter(B=>B.id!==E))};return h("main",{children:[h(Le,{isOpen:f,onClose:()=>d(!1),children:[i(le,{}),h(pe,{children:[i(ie,{children:"Finish the Reservation"}),i(oe,{}),i(ce,{children:"This will create a reservation and send conformation email to the customer"}),h(Ee,{children:[i(I,{colorScheme:"green",mr:3,onClick:()=>{x()},children:"Confirm"}),i(I,{variant:"ghost",onClose:()=>d(!1),children:"Close"})]})]})]}),i(Be,{isOpen:w,onClose:()=>{p(!1)},eventId:e==null?void 0:e.EventId}),e&&i(ct,{isOpen:t,onClose:()=>s(!1),eventId:e.EventId,invoice:n[0],reservationId:l,onSuccessPayment:E=>M(E)}),h("div",{className:"flex flex-col lg:flex-row w-full",children:[h("div",{className:"flex flex-col w-full",children:[h(b,{bg:P("white","gray.700"),className:"my-4 p-5 rounded-lg shadow-md p-3",children:[h("div",{className:"flex flex-row items-center space-x-4",children:[i("h1",{className:"text-2xl font-bold",children:"Reservation Summary"}),e&&o.statuses&&i(X,{className:"my-3 rounded-lg",fontSize:"0.9em",colorScheme:Q(z(o.statuses.Reservation,e.StatusId).tag||""),children:z(o.statuses.Reservation,e==null?void 0:e.StatusId).tag})]}),h("div",{className:"flex flex-row justify-between",children:[h("div",{className:"flex flex-col",children:[h("div",{className:"text-sm",children:["Created:",i("span",{className:"ml-2 font-bold",children:T(e==null?void 0:e.createdAt).tz("America/Toronto").format("DD MMM, YYYY [at] HH:mma")})]}),h("div",{className:"text-sm",children:["Created By:",i("span",{className:"ml-2 font-bold",children:e==null?void 0:e.createdBy})]})]}),h("div",{className:"w-4/12 flex",children:["People on reservation: ",i("b",{children:e==null?void 0:e.ClientLists.length})]})]}),!!n.length&&i("div",{className:"my-5",children:i(Ce,{type:"warning",message:h("div",{className:"flex flex-row justify-between items-center w-full",children:["This Reservation has outstanding invoice!",h(I,{colorScheme:"orange",size:"sm",className:"ml-2",onClick:()=>s(!0),children:[i(ae,{className:"mr-2"})," ",i("span",{children:"Resolve Payment"})]})]})})}),h("div",{className:"flex sm:flex-row flex-col mt-3",children:[e&&(e==null?void 0:e.ClientLists.length)<Ne&&i("div",{className:"flex flex-row justify-start sm:w-8/12 w-full",children:h(I,{className:"mt-2 sm:w-6/12 w-full",colorScheme:"orange",size:{base:"xs",md:"sm"},onClick:()=>p(!0),children:[i(Ae,{className:"mr-2"})," Add Guest"]})}),h("div",{className:"flex sm:flex-row flex-col justify-end w-full",children:[e&&o.statuses&&e.StatusId===o.statuses.Reservation.ACTIVE&&h(I,{className:"mt-2 sm:w-6/12 w-full mr-2",colorScheme:"blue",size:{base:"xs",md:"sm"},children:[i(re,{className:"mr-2"})," Send Confirmation Email"]}),e&&o.statuses&&e.StatusId!==o.statuses.Reservation.ACTIVE&&e.StatusId!==o.statuses.Reservation.AWAITING_PAYMENT&&h(I,{colorScheme:"green",size:{base:"xs",md:"sm"},className:"mt-2 sm:w-6/12 w-full mr-2",onClick:()=>d(!0),children:[i(Me,{className:"mr-2"})," Confirm Reservation"]}),h(I,{className:"mt-2 sm:w-6/12 w-full",colorScheme:"red",size:{base:"xs",md:"sm"},children:[i(Ue,{className:"mr-2"})," Cancel Reservation"]})]})]})]}),h(b,{className:"shadow-lg my-4 p-5 rounded-lg",bg:P("white","gray.700"),children:[i(k,{as:"h2",size:"md",my:3,children:"Guests"}),i("div",{className:"flex flex-col w-full space-y-3",children:o.statuses&&((y=e==null?void 0:e.ClientLists)==null?void 0:y.map(E=>i(lt,{statuses:o.statuses,clientList:E,enableDelete:m,onCheckIn:B=>console.log({clientList:B})},E.reservationCode)))})]})]}),h(b,{bg:P("white","gray.700"),className:"lg:mx-5 h-full lg:w-5/12 w-full my-4 p-3 rounded-lg",children:[i("div",{className:"p-3",children:i(k,{as:"h2",size:"md",children:"Event Information"})}),h("div",{className:"flex flex-row justify-between w-full mt-6",children:[h("div",{className:"text-left w-full ml-3 flex flex-col",children:[i("span",{className:"font-bold text-sm ",children:"Start Time"}),i("span",{className:"text-base font-medium tracking-wide",children:T((R=e==null?void 0:e.Event)==null?void 0:R.startTime).tz("America/Toronto").utc().format("DD MMM, YYYY [at] HH:mma")})]}),i(b,{bg:P("gray.500","white"),className:"inline-block h-[90px] min-h-[1em] w-0.5 self-stretch opacity-100 dark:opacity-50"}),h("div",{className:"text-left w-full ml-10 flex flex-col",children:[i("span",{className:"font-bold text-sm tracking-wide leading-relaxed",children:"End Time"}),h("span",{className:"text-base font-medium tracking-wide",children:[" ",T((D=e==null?void 0:e.Event)==null?void 0:D.endTime).tz("America/Toronto").utc().format("DD MMM, YYYY [at] HH:mma")]})]})]}),i("div",{className:"flex flex-row justify-between w-full mt-6",children:h("div",{className:"text-left w-full ml-3 flex flex-col",children:[i("span",{className:"font-bold text-sm ",children:"Name"}),i("span",{className:"text-base font-normal tracking-wide",children:(W=e==null?void 0:e.Event)==null?void 0:W.name})]})}),i("div",{className:"flex flex-row justify-between w-full mt-6",children:h("div",{className:"text-left w-full ml-3 flex flex-col",children:[i("span",{className:"font-bold text-sm ",children:"Location"}),i("span",{className:"text-base font-normal tracking-wide",children:(K=e==null?void 0:e.Event)==null?void 0:K.location})]})}),i("div",{className:"flex flex-row justify-between w-full mt-6",children:h("div",{className:"text-left w-full ml-3 flex flex-col",children:[i("span",{className:"font-bold text-sm ",children:"Event Capacity"}),i("span",{className:"text-base font-normal tracking-wide",children:(Z=e==null?void 0:e.Event)==null?void 0:Z.capacity})]})})]})]}),o.statuses&&!!((J=e==null?void 0:e.Invoices)!=null&&J.length)&&h(b,{bg:v,className:"my-4 p-5 shadow-lg rounded-lg w-full",children:[i(k,{as:"h2",size:"md",my:3,children:"Invoices"}),i($e,{statuses:o.statuses,paymentIntents:e==null?void 0:e.Invoices})]})]})},Pt=ve(dt);export{Pt as default};
